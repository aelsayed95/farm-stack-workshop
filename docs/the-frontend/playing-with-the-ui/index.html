<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" as="font" href="https://judy2k.github.io/farm-stack-workshop/fonts/vendor/jost/jost-v4-latin-regular.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="https://judy2k.github.io/farm-stack-workshop/fonts/vendor/jost/jost-v4-latin-700.woff2"  type="font/woff2" crossorigin>


<link rel="stylesheet" href="https://judy2k.github.io/farm-stack-workshop/main.css">



  
  
    
  

  
  
    
    
  
  
  
    
  
  
  
  
    
  
  
  


  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">


	


	

<title>Playing with the app | FARM Stack Workshop</title>
<meta name="description" content="Let&#x27;s put together a FARM Stack site!">
<link rel="canonical" href="https://judy2k.github.io/farm-stack-workshop/docs/the-frontend/playing-with-the-ui/">










<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    
      
      
        
        
        
        
        
        
        
        
          {
            "@type": "ListItem",
            "position":  1 ,
            "name": "Home",
            "item": "https://judy2k.github.io/farm-stack-workshop/"
          },
          
          
          {
            "@type": "ListItem",
            "position":  2 ,
            "name": "Docs",
            "item": "https://judy2k.github.io/farm-stack-workshop/docs/"
          },
        
      
        
        
        
        
        
        
        
        
        
        
        
          
          
          {
            "@type": "ListItem",
            "position":  3 ,
            "name": "The Frontend",
            "item": "https://judy2k.github.io/farm-stack-workshop/docs/the-frontend/"
          },
        
      
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
          
          
          {
            "@type": "ListItem",
            "position":  4 ,
            "name": "Playing With The Ui",
            "item": "https://judy2k.github.io/farm-stack-workshop/docs/the-frontend/playing-with-the-ui/"
          },
        
      
    
  }
</script>






  <meta name="theme-color" content="#fff">
  <link rel="apple-touch-icon" sizes="180x180" href="https://judy2k.github.io/farm-stack-workshop/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://judy2k.github.io/farm-stack-workshop/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://judy2k.github.io/farm-stack-workshop/favicon-16x16.png">
  
    <link rel="manifest" href="https://judy2k.github.io/farm-stack-workshop/site.webmanifest" crossorigin>
  


  

</head>

  

<body class="docs single">
  
  
  
  
<div class="header-bar fixed-top"></div>
<header class="navbar fixed-top navbar-expand-md navbar-light">
	<div class="container">
		<input class="menu-btn order-0" type="checkbox" id="menu-btn">
		<label class="menu-icon d-md-none" for="menu-btn"><span class="navicon"></span></label>
		<a class="navbar-brand order-1 order-md-0 me-auto" href="https://judy2k.github.io/farm-stack-workshop">FARM Stack Workshop</a>
		<button id="mode" class="btn btn-link order-2 order-md-4" type="button" aria-label="Toggle mode">
			<span class="toggle-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></span>
			<span class="toggle-light"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></span>
		</button>
		<ul class="navbar-nav fork-me order-3 order-md-5">
			
				
					<li class="nav-item">
						<a class="nav-link" href="https://twitter.com/judy2k"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg><span class="ms-2 visually-hidden">Twitter</span></a>
					</li>
				
			
		</ul>
		<div class="collapse navbar-collapse order-4 order-md-1">
			<ul class="navbar-nav main-nav me-auto order-5 order-md-2">
				
					
				
				
				
					
						<li class="nav-item docs active">
							<a class="nav-link" href="https://judy2k.github.io/farm-stack-workshop/docs/">Docs</a>
						</li>
					
				
			</ul>
			<div class="break order-6 d-md-none"></div>
			
				<form class="navbar-form flex-grow-1 order-7 order-md-3">
					<input id="userinput" class="form-control is-search" type="search" placeholder="Search docs..."
						aria-label="Search docs..." autocomplete="off">
					<div id="suggestions" class="shadow bg-white rounded"></div>
				</form>
			
		</div>
	</div>
</header>



  
<div class="wrap container" role="document">
  <div class="content">
    <div class="row flex-xl-nowrap">
	  
<div class="col-lg-5 col-xl-4 docs-sidebar">
	<nav class="docs-links" aria-label="Main navigation">
			
			
			
			
					
					
					
							<h3>Getting Set Up</h3>
							<ul class="list-unstyled">
							                           
									<li><a class="docs-link" href="https://judy2k.github.io/farm-stack-workshop/docs/getting-set-up/create-an-atlas-account/">Create an Atlas Account</a></li>
							                           
									<li><a class="docs-link" href="https://judy2k.github.io/farm-stack-workshop/docs/getting-set-up/spin-up-a-cluster/">Spin Up a Cluster</a></li>
							                           
									<li><a class="docs-link" href="https://judy2k.github.io/farm-stack-workshop/docs/getting-set-up/getting-the-code/">Getting The Code</a></li>
							                           
									<li><a class="docs-link" href="https://judy2k.github.io/farm-stack-workshop/docs/getting-set-up/installation/">Install Your Dependencies</a></li>
							
					</ul>
					
					
					
					
							<h3>The Backend</h3>
							<ul class="list-unstyled">
							                           
									<li><a class="docs-link" href="https://judy2k.github.io/farm-stack-workshop/docs/the-backend/installing-dependencies/">Installing backend dependencies</a></li>
							                           
									<li><a class="docs-link" href="https://judy2k.github.io/farm-stack-workshop/docs/the-backend/configure-and-run/">Configure and run the backend app</a></li>
							                           
									<li><a class="docs-link" href="https://judy2k.github.io/farm-stack-workshop/docs/the-backend/exploring-the-fastapi-interface/">Exploring the FastAPI interface</a></li>
							
					</ul>
					
					
					
					
							<h3>The React Frontend</h3>
							<ul class="list-unstyled">
							                           
									<li><a class="docs-link" href="https://judy2k.github.io/farm-stack-workshop/docs/the-frontend/install-and-run/">Install and run the React app</a></li>
							                           
									<li><a class="docs-link active" href="https://judy2k.github.io/farm-stack-workshop/docs/the-frontend/playing-with-the-ui/">Playing with the app</a></li>
							                           
									<li><a class="docs-link" href="https://judy2k.github.io/farm-stack-workshop/docs/the-frontend/add-a-component/">Add a React Component</a></li>
							                           
									<li><a class="docs-link" href="https://judy2k.github.io/farm-stack-workshop/docs/the-frontend/update-task-status/">Sending updates to the server</a></li>
							                           
									<li><a class="docs-link" href="https://judy2k.github.io/farm-stack-workshop/docs/the-frontend/next-steps/">Next steps</a></li>
							
					</ul>
					
					
			
	</nav>
</div>

	  
  

      <main class="docs-content col-lg-11 col-xl-9">
        <h1>Playing with the app</h1>
        
        <p>If everything's gone to plan, when you load up <a href="http://localhost:3000/">http://localhost:3000/</a>,
you should see a simple to-do list.</p>
<p>
    
    <img src="https:&#x2F;&#x2F;judy2k.github.io&#x2F;farm-stack-workshop&#x2F;processed_images&#x2F;1ade32298b8db17300.png" />
</p>
<p>At the moment, the page is not interactive.</p>
<h1 id="looking-through-the-stack">Looking through the stack</h1>
<p>Behind the scenes, though, it's polling the backend server for the task list once every second.
That's due to this line of code in <code>App.js</code> in the frontend app:</p>
<pre data-lang="js" style="background-color:#2b303b;color:#c0c5ce;" class="language-js "><code class="language-js" data-lang="js"><span style="color:#b48ead;">const </span><span style="color:#bf616a;">interval </span><span>= </span><span style="color:#96b5b4;">setInterval</span><span>(</span><span style="color:#bf616a;">fetchAllTasks</span><span>, </span><span style="color:#d08770;">1000</span><span>)
</span></code></pre>
<p>That configures the browser to call <code>fetchAllTasks</code> once every second.
The <code>fetchAllTasks</code> function looks like this:</p>
<pre data-lang="js" style="background-color:#2b303b;color:#c0c5ce;" class="language-js "><code class="language-js" data-lang="js"><span style="color:#b48ead;">const </span><span style="color:#8fa1b3;">fetchAllTasks </span><span>= </span><span style="color:#b48ead;">async </span><span>() </span><span style="color:#b48ead;">=&gt; </span><span>{
</span><span>    </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">response </span><span>= </span><span style="color:#b48ead;">await </span><span style="color:#8fa1b3;">fetch</span><span>(&quot;</span><span style="color:#a3be8c;">/task/</span><span>&quot;)
</span><span>    </span><span style="color:#b48ead;">const </span><span style="color:#bf616a;">tasks </span><span>= </span><span style="color:#b48ead;">await </span><span style="color:#bf616a;">response</span><span>.</span><span style="color:#8fa1b3;">json</span><span>()
</span><span>    </span><span style="color:#8fa1b3;">setTasks</span><span>(</span><span style="color:#bf616a;">tasks</span><span>);
</span><span>}
</span></code></pre>
<p>It's making a <code>GET</code> request to the &quot;List Tasks&quot; FastAPI endpoint.
This may be surprising to you,
because this request is actually being made to the <em>JavaScript</em> web server,
(because no host and port was provided in the URL).
Somehow it's being forwarded to the FastAPI server.</p>
<p>This proxying behaviour is configured in the <code>package.json</code> file for this app:</p>
<pre data-lang="json" style="background-color:#2b303b;color:#c0c5ce;" class="language-json "><code class="language-json" data-lang="json"><span>&quot;</span><span style="color:#a3be8c;">proxy</span><span>&quot;: &quot;</span><span style="color:#a3be8c;">http://localhost:8000</span><span>&quot;
</span></code></pre>
<p>This reflects many real-world environments where a reverse-proxy will be configured in front of your static webserver
(that will serve your React app)
and your FastAPI endpoints from a single host.</p>
<p>The FastAPI endpoint is configured in <code>apps/todo/routers.py</code> in the <code>backend</code> app.</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span>@router.</span><span style="color:#bf616a;">get</span><span>(&quot;</span><span style="color:#a3be8c;">/</span><span>&quot;, </span><span style="color:#bf616a;">response_description</span><span>=&quot;</span><span style="color:#a3be8c;">List all tasks</span><span>&quot;)
</span><span style="color:#b48ead;">async def </span><span style="color:#8fa1b3;">list_tasks</span><span>(</span><span style="color:#bf616a;">request</span><span>: Request):
</span><span>    </span><span style="color:#b48ead;">return await </span><span>request.app.mongodb.</span><span style="color:#bf616a;">get_collection</span><span>(&quot;</span><span style="color:#a3be8c;">tasks</span><span>&quot;).</span><span style="color:#bf616a;">find</span><span>().</span><span style="color:#bf616a;">to_list</span><span>(</span><span style="color:#bf616a;">length</span><span>=</span><span style="color:#d08770;">100</span><span>)
</span></code></pre>
<p>This endpoint is making a <a href="https://pymongo.readthedocs.io/en/stable/tutorial.html#querying-for-more-than-one-document">find()</a> request for all of the documents in the collection,
and then returning it.
FastAPI handles the serialization to JSON, which is then sent to the browser in response to the polling call.</p>
<h1 id="modify-the-database">Modify the database</h1>
<p>What does this all mean?
If you can update the database, you can change what you see in the browser.
There are three ways to do this:</p>
<ol>
<li>You can craft the appropriate Rest API call in <code>curl</code> or <code>httpie</code> or <code>xh</code>.</li>
<li>You could use the FastAPI interface to craft the appropriate Rest API call.</li>
<li>You can go directly to the database and update the records.</li>
</ol>
<p>Because you're using a cluster in MongoDB Atlas,
you have a nice web-based interface for making queries and updates available to you.</p>
<ol>
<li>Open up a browser tab to your cluster in MongoDB Atlas.</li>
<li>Click on &quot;Browse Collections&quot;</li>
<li>Select your &quot;farmstack&quot; database, and then your &quot;tasks&quot; collection.
(If it's not already selected.)</li>
</ol>
<p>You should see your to-do tasks.
Double click on the value of &quot;completed&quot; and change the value.
Switch back to the frontend app in your browser, and you should see the checkbox for that item change!</p>
<h1 id="an-aside-about-websockets-and-change-streams">An aside about Websockets and Change Streams</h1>
<p>Polling the database isn't actually a very efficient or responsive way to update the frontend interface,
but we were trying to keep the app simple.
It would be much better if we could <em>listen</em> to the collection and receive events <em>only</em> when the data in the collection changes.
MongoDB actually contains this feature!
It's called <a href="https://www.mongodb.com/docs/manual/changeStreams/">Change Streams</a>.
With PyMongo or Motor, you can use the <code>watch()</code> method to receive a stream of changes to a collection.</p>
<p>With <a href="https://www.starlette.io/">starlette</a>
(the web server engine that FastAPI is built on)
it should be relatively straightforward to have a WebSocket or Server-Side Event endpoint
that will push change stream events up to the browser.
Check out <a href="https://github.com/sysid/sse-starlette">SSE-Starlette</a> for one way to do that.</p>
<h1 id="what-s-next">What's Next?</h1>
<p>You've kind of checked out the current capabilities of the app.
Let's add some new functionality,
starting with the ability to add new tasks to the to-do list.</p>

        
        
<div class="docs-navigation d-flex justify-content-between">
  
  
  
  
  
    
    
    
    
      
        
        
          
        
      
        
        
          
            
              
              <a href="https:&#x2F;&#x2F;judy2k.github.io&#x2F;farm-stack-workshop&#x2F;docs&#x2F;the-backend&#x2F;exploring-the-fastapi-interface&#x2F;">
                <div class="card my-1">
                  <div class="card-body py-2">
                    &larr; Exploring the FastAPI interface
                  </div>
                </div>
              </a>
            
            
            
          
        
      
        
        
          
        
      
    
  

  
  
  
  
  
    
    
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
  
</div>

      </main>
    </div>
  </div>
</div>


  
    
<footer class="footer text-muted">
	<div class="container">
		<div class="row">
			<div class="col-lg-8 order-last order-lg-first">
				<ul class="list-inline">
					
						<li class="list-inline-item">Brought to you by <a href="https://www.mongodb.com/">MongoDB</a></li>
					
				</ul>
			</div>
			<div class="col-lg-8 order-first order-lg-last text-lg-end">
				<ul class="list-inline">
					
				</ul>
			</div>
		</div>
	</div>
</footer>

  

  
<script type="text/javascript" src="https://judy2k.github.io/farm-stack-workshop/js/main.js" defer></script>

  <script type="text/javascript" src="https://judy2k.github.io/farm-stack-workshop/plugins/elasticlunr.min.js" defer></script>
  <script type="text/javascript" src="https://judy2k.github.io/farm-stack-workshop/search_index.en.js" defer></script>
  <script type="text/javascript" src="https://judy2k.github.io/farm-stack-workshop/js/search.js" defer></script>

  
</body>
</html>
